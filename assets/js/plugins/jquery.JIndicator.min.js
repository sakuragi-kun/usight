/*! <%= pkg.title || pkg.name %> - v<%= pkg.version %> - <%= grunt.template.today("yyyy-mm-dd") %>
<%= pkg.homepage ? "* " + pkg.homepage + "\n" : "" %>* Copyright (c) <%= grunt.template.today("yyyy") %> <%= pkg.author.name %>; Licensed <%= _.pluck(pkg.licenses, "type").join(", ") %> */
!function(a){"use strict";function b(a,b,c){c.legend&&c.legend.data&&3===c.legend.data.length?c.middleHeight=c.canvasHeight/2+c.legendHeight:c.middleHeight=c.canvasHeight/2,c.tHeight=c.barHeight*Math.sin(Math.PI/3),c.triangleHeight=c.tHeight+8,a.height+=0,b.font=c.numberText.fontSize+"px "+c.numberText.fontFamily,b.textAlign=c.numberText.align}function c(a,b){a.beginPath(),a.moveTo(b.startX,b.middleHeight),a.lineTo(b.startX+b.triangleHeight,b.middleHeight-b.barHeight/2),a.lineTo(b.startX+b.triangleHeight,b.middleHeight+b.barHeight/2),a.fillStyle=b.barColor.left,a.fill(),a.closePath(),a.fillRect(b.startX+b.triangleHeight,b.middleHeight-b.barHeight/2,b.barWidth-b.triangleHeight,b.barHeight)}function d(a,b){a.fillStyle=b.barColor.middle,a.fillRect(b.startX+b.barWidth,b.middleHeight-b.barHeight/2,b.barWidth,b.barHeight)}function e(a,b){a.fillStyle=b.barColor.right,a.fillRect(b.startX+2*b.barWidth,b.middleHeight-b.barHeight/2,b.barWidth-b.triangleHeight,b.barHeight),a.beginPath(),a.moveTo(b.startX+3*b.barWidth,b.middleHeight),a.lineTo(b.startX+3*b.barWidth-b.triangleHeight,b.middleHeight-b.barHeight/2),a.lineTo(b.startX+3*b.barWidth-b.triangleHeight,b.middleHeight+b.barHeight/2),a.fill(),a.closePath()}function f(a,b,c,d,e,f,g){a.beginPath(),a.arc(b+f,c+f,f,Math.PI,3*Math.PI/2),a.lineTo(d-f+b,c),a.arc(d-f+b,f+c,f,3*Math.PI/2,2*Math.PI),a.lineTo(d+b,e+c-f),a.arc(d-f+b,e-f+c,f,0,Math.PI/2),a.lineTo(f+b,e+c),a.arc(f+b,e-f+c,f,Math.PI/2,Math.PI),a.fillStyle=g,a.fill(),a.closePath()}function g(a,b){var c,d=b.legendProperty.margin/3,e=5,g=b.canvasWidth/2,h=b.legendProperty.margin+b.legendProperty.width+a.measureText(b.legend.data[0]).width;c=(b.legendProperty.width+a.measureText(b.legend.data[1]).width+d)/2,h=b.legendProperty.width+a.measureText(b.legend.data[0]).width+d,g=g-c-h-b.legendProperty.margin,f(a,g,e,b.legendProperty.width,b.legendProperty.height,b.legendProperty.radius,b.barColor.left),a.fillStyle=b.legend.textColor,a.fillText(b.legend.data[0],g+b.legendProperty.width+d,e+b.legendProperty.height-5),g=g+h+b.legendProperty.margin,f(a,g,e,b.legendProperty.width,b.legendProperty.height,b.legendProperty.radius,b.barColor.middle),a.fillStyle=b.legend.textColor,a.fillText(b.legend.data[1],g+b.legendProperty.width+d,e+b.legendProperty.height-5),g=g+2*c+b.legendProperty.margin,f(a,g,e,b.legendProperty.width,b.legendProperty.height,b.legendProperty.radius,b.barColor.right),a.fillStyle=b.legend.textColor,a.fillText(b.legend.data[2],g+b.legendProperty.width+d,e+b.legendProperty.height-5)}function h(a){var b={color:a.barColor.left,positionX:a.startX,positionArcY:a.middleHeight-a.barHeight-4,positionTriY:a.middleHeight-a.barHeight/2-1};return isNaN(a.indicatorValue)?b:a.barValues.length<3||isNaN(a.barValues[1])||isNaN(a.barValues[2])?b:(b.color=a.barColor.left,a.indicatorValue<a.barValues[1]?isNaN(a.barValues[0])?(b.positionX=a.startX+a.barWidth/2,b):a.indicatorValue<a.barValues[0]?(b.positionX=a.startX,b):(b.positionX=a.startX+a.barWidth*(a.indicatorValue-a.barValues[0])/(a.barValues[1]-a.barValues[0]),b):a.indicatorValue===a.barValues[1]?(b.positionX=a.startX+a.barWidth,b.color=a.barColor.middle,b):(b.color=a.barColor.right,a.indicatorValue>a.barValues[2]?3===a.barValues.length||isNaN(a.barValues[3])?(b.positionX=a.startX+2*a.barWidth+a.barWidth/2,b):a.indicatorValue>a.barValues[3]?(b.positionX=a.startX+3*a.barWidth,b):(b.positionX=a.startX+2*a.barWidth+a.barWidth*(a.indicatorValue-a.barValues[2])/(a.barValues[3]-a.barValues[2]),b):a.indicatorValue===a.barValues[2]?(b.positionX=a.startX+2*a.barWidth,b):(b.color=a.barColor.middle,b.positionX=a.startX+a.barWidth+a.barWidth*(a.indicatorValue-a.barValues[1])/(a.barValues[2]-a.barValues[1]),b)))}function i(a,b){var c=b.indicatorColor,d=h(b);"auto"!==c&&(d.color=c),a.beginPath(),a.arc(d.positionX,b.middleHeight-b.barHeight-4,b.barHeight/2,0,Math.PI,1),a.fillStyle=d.color,a.fill(),a.moveTo(d.positionX-b.barHeight/2-1,d.positionArcY),a.lineTo(d.positionX,d.positionTriY),a.lineTo(d.positionX+b.barHeight/2+1,d.positionArcY),a.fillStyle=d.color,a.fill(),a.closePath(),a.fillText(b.indicatorValue,d.positionX+b.barHeight/2+3,d.positionTriY-b.triangleHeight/6)}function j(a,b){var c,d,e;for(a.fillStyle=b.numberText.color,d=0;d<b.barValues.length;d+=1)isNaN(b.barValues[d])||(e=b.startX+b.barWidth*d,c=a.measureText(b.barValues[d]),a.fillText(b.barValues[d],e-c.width/2,b.middleHeight+b.barHeight/2+b.numberText.fontHeight+3))}function k(a,f){var h,k,l;f.canvasWidth=3*f.barWidth+2*f.startX,0===a.find("#jIndicatorCanvas").length&&(f.canvasHeight=2*f.canvasHeight,f.canvasWidth=2*f.canvasWidth,f.barHeight=2*f.barHeight,f.barWidth=2*f.barWidth,f.numberText.fontHeight=2*f.numberText.fontHeight,f.numberText.fontSize=2*f.numberText.fontSize,f.legendHeight=2*f.legendHeight,f.legendProperty.height=2*f.legendProperty.height,f.legendProperty.width=2*f.legendProperty.width,f.legendProperty.margin=2*f.legendProperty.margin,f.legendProperty.radius=2*f.legendProperty.radius,l='<canvas id="jIndicatorCanvas" width="'+f.canvasWidth+'" height="'+f.canvasHeight+'"',l+=' style="width: '+f.canvasWidth/2+"px; height: "+f.canvasHeight/2+'px;"',l+="></canvas>",a.append(l)),h=a.find("#jIndicatorCanvas").get(0),k=h.getContext("2d"),b(h,k,f),c(k,f),d(k,f),e(k,f),f.legend&&f.legend.data&&3===f.legend.data.length&&g(k,f),i(k,f),j(k,f)}var l=function(b,c){this.$element=a(b),this.defaults={canvasHeight:70,canvasWidth:500,startX:10,barHeight:12,barWidth:150,barColor:{left:"#7BD6FD",middle:"#77DE8B",right:"#FFC977"},indicatorColor:"auto",numberText:{color:"#000000",fontSize:13,fontFamily:"Arial",align:"left",fontHeight:12},barValues:[],indicatorValue:0,legend:{data:["low","middle","high"],textColor:"#000000"},legendHeight:15,legendProperty:{height:15,width:24,margin:15,radius:4}},this.options=a.extend({},this.defaults,this.options,"object"==typeof c&&c)};a.fn.JIndicator=function(b){return this.each(function(){var c=this;return void 0===c.indicator?c.indicator=new l(this,b):c.indicator.options=a.extend({},c.indicator.options,b),c.indicator.drawCanvas(c)})},l.prototype={drawCanvas:function(a){return k(this.$element,this.options),a.indicator}}}(jQuery);